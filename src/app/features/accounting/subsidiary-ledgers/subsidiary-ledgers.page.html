<div class="subview-container">
    <div class="subview-header">
        <h3>Subsidiary Ledgers</h3>
        <div class="header-actions">
            <button class="secondary-button">
                <lucide-icon [img]="CalendarIcon" size="16"></lucide-icon>
                <span>Jul 2025</span>
            </button>
            <button class="secondary-button">
                <lucide-icon [img]="FilterIcon" size="16"></lucide-icon>
                <span>Filters</span>
            </button>
            <button class="primary-button">
                <lucide-icon [img]="ExportIcon" size="16"></lucide-icon>
                <span>Export</span>
            </button>
        </div>
    </div>

    <div class="filter-bar card">
        <div class="form-field">
            <label for="controlAccount">Control Account</label>
            <select id="controlAccount">
                <option selected>{{ selectedControlAccount().code }} - {{ selectedControlAccount().name }}</option>
                <option>2100 - Accounts Payable</option>
            </select>
        </div>
        <div class="form-field">
            <label for="auxiliary">Auxiliary (Third-Party)</label>
            <select id="auxiliary">
                <option selected>{{ selectedAuxiliary().name }}</option>
                <option>Cliente Ejemplo S.R.L.</option>
            </select>
        </div>
    </div>

    <div class="ledger-header card">
        <h4>Auxiliary: <span class="account-name">{{ selectedAuxiliary().name }}</span></h4>
        <div class="balance-summary">
            <div class="balance-item">
                <span>Initial Balance</span>
                <strong>{{ initialBalance() | number:'1.2-2' }}</strong>
            </div>
            <div class="balance-item">
                <span>Final Balance</span>
                <strong>{{ finalBalance() | number:'1.2-2' }}</strong>
            </div>
        </div>
    </div>

    <div class="table-container card">
        <table class="data-table ledger-table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Reference #</th>
                    <th>Description</th>
                    <th class="text-right">Debit</th>
                    <th class="text-right">Credit</th>
                    <th class="text-right">Balance</th>
                </tr>
            </thead>
            <tbody>
                @for (line of ledgerLines(); track $index) {
                <tr>
                    <td>{{ line.date }}</td>
                    <td>
                        @if(line.entryNumber !== 'OPEN') {
                        <a href="#" class="table-link">{{ line.entryNumber }}</a>
                        } @else {
                        <span>{{ line.entryNumber }}</span>
                        }
                    </td>
                    <td>{{ line.description }}</td>
                    <td class="text-right amount-cell">{{ line.debit | number:'1.2-2' }}</td>
                    <td class="text-right amount-cell">{{ line.credit | number:'1.2-2' }}</td>
                    <td class="text-right balance-cell">{{ line.balance | number:'1.2-2' }}</td>
                </tr>
                } @empty {
                <tr>
                    <td colspan="6" class="empty-state">No movements found for this auxiliary in the selected period.
                    </td>
                </tr>
                }
            </tbody>
        </table>
    </div>
</div>